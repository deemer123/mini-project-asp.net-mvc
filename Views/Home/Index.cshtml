@{
    ViewData["Title"] = "Home Page";
    var selectedCategoryId = ViewBag.SelectedCategoryId as int?;
    var categories = ViewBag.Categories as List<DemoVolunteer.Models.Category>;
    var selectedCategory = categories?.FirstOrDefault(c => c.CategoryId == selectedCategoryId);
}
<link rel="stylesheet" href="~/css/index.css" />
<link rel="stylesheet" href="~/css/style_global.css" />

<main class="main">
    <div class="content">

        <!-- for title -->
        <div class="layer1">
            <img style="width: 150px; height: 150px; object-fit: cover; border-radius: 50%; overflow: hidden;"
                src="https://s.imgz.io/2025/09/08/download-1f4108ab663ec19eb.png" alt="picture">
            <div class="text1">
                <h1>มาปันสุข</h1>
                <p>มาปันสุขให้กับสังคมไทยให้ สดใจ กัน.. <br>
                    หากคุณคือ “อาสา”</p>
            </div>
        </div>
        <!-- for activity -->
        <div class="layer2" style="display: flex;">
            <hr class="line">
            <h2 class="title2">กิจกรรมจิตอาสาที่เปิดรับ</h2>
            <hr class="line">
        </div>
        <!-- for search --> 
        <form asp-action="Search" asp-controller="Home" method="get">
        <div class="search-container">
                <input type="text" placeholder="ค้นหางานกิจกรรม" class="search-input" name="keyword" id="keyword" placeholder="ค้นหากิจกรรม"/>
                <button class="btn bg_blue" type="submit">ค้นหา</button>
        </div>
        </form>

        <!-- for select activity -->

        <div class="selectbutton">
            <a class="btn" asp-controller="Home" asp-action="Index">ทั้งหมด</a>
            @foreach (var category in @ViewBag.Categories)
            {   //แก้ไขการ filter ตามหมวดหมู่
                <a class="btn" asp-controller="Home" asp-action="Index" asp-route-categorieId="@category.CategoryId">@category.Name</a>
            }
        </div>

        @* all post *@
        @model List<DemoVolunteer.Models.Post>
        <div class="showactivity">
            @foreach (var post in Model)
{
    if (selectedCategoryId == null || post.CategoryId == selectedCategoryId)
    {
        
        <div class="activity">
            @if(post.ImgURL != null){
                <img class="img-preview" src="@post.ImgURL"  alt="volunteer" width="100px">
            }else{
                <img class="img-preview" src="~/img/default-post-pic.jpg" alt="img" width="100px">
            }
            <h4>@post.Title</h4>
            <p>
                สถานที่: @post.Location <br>
                วันที่: @post.AppointmentDate.ToString("dd MMM yyyy", new System.Globalization.CultureInfo("th-TH")) <br>
                เวลา: @post.TimeStart.ToString("HH:mm") - @post.TimeEnd.ToString("HH:mm") น. <br>
                ผู้จัด: @post.Owner.FullName
            </p>
            <div>
                @if (User.Identity.IsAuthenticated)
                {
                   <div>
                        <a asp-controller="Post" asp-action="Detail" asp-route-postId="@post.PostId" class="btn join ">เข้าร่วม</a>
                    </div>
                }
                else
                {
                    <div><a class="btn join " asp-controller="User" asp-action="Login">เข้าร่วม</a></div>
                }
            </div>
        </div>
    }
}      

            @* next pages *@
        </div>
         <div class="sliderbar" id="pager" aria-label="เปลี่ยนหน้า">
                <button class="swiper-button" data-dir="-1" aria-label="ก่อนหน้า">‹</button>
                <div class="sliderbar-track" id="pagerTrack"></div>
                <button class="swiper-button" data-dir="1" aria-label="ถัดไป">›</button>
            </div>
    </div>
    </div>


</main>

@* <script src="~/js/index.js"></script>
<script src="~/js/nav.js" defer></script> *@

