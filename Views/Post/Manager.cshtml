@model List<DemoVolunteer.Models.Post>

<link rel="stylesheet" href="~/css/managepost.css" />
<link rel="stylesheet" href="~/css/style_global.css">
<link rel="stylesheet" href="~/css/viewmember.css">
@* <h1>จัดการโพส</h1>

<p>โพสสมาชิกอื่น @ViewBag.joinAmount</p>
<p>โพสของฉัน @Model.Count</h2>
<p>โพสทั้งหมด @ViewBag.postAmount</p>

<ul>
    @if (Model == null || !Model.Any())
    {
        <li>ยังไม่มีการโพส</li>
    }
    else
    {
        @foreach (Post post in Model)
        {
            <li>วันที่สร้าง @post.CreatedAt - ชื่อ @post.Title - จำนวนรับ @post.AmountParticipant/@post.MaxParticipants
                <a href="/Post/PostJoinList?postId=@post.PostId">ดูจำนวนสมาชิก</a>x`
                <a href="/Post/Edit?postId=@post.PostId">แก้ไข</a>
                <a href="/Post/Delete?postId=@post.PostId">ลบ</a>
                <a href="#">ปิดรับคนสมัคร</a>
            </li>
        }
    }

</ul> *@


<main>
    <div class="content">
        <div class="layer-1">
            <div class="title_summary">
                <h2>จัดการโพสต์กิจกรรมของฉัน</h2>
            </div>

            <div class="summary-boxes">
                <div class="box orange">โพสต์สมาชิกอื่น<br><br>@ViewBag.joinAmount</div>
                <div class="box green">โพสต์ของฉัน<br><br>@Model.Count</div>
                <div class="box blue">โพสต์ทั้งหมด<br><br>@ViewBag.postAmount</div>
            </div>
            <div class="forpost"><a asp-controller="Post" asp-action="Create"><button
                        class="btn bg_yellow">เพิ่มโพสต์</button></a></div>
            @if (Model == null || !Model.Any())
            {
                <div>ยังไม่มีโพสต์</div>
            }
            else
            {
                <div class="layer-2">
                        <table>
                            <thead>
                                <th class="headtable" colspan="5">รายการจิตอาสาที่ฉันสร้าง</th>
                                <tr>
                                    <th>วันที่สร้าง</th>
                                    <th>งานอาสา</th>
                                    <th>จำนวนรับ</th>
                                    <th>ดูสมาชิก</th>
                                    <th>แก้ไขโพสต์</th>
                                    <th>ลบโพสต์</th>
                                    <th>สถานะรับสมัคร</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (Post post in Model)
                {
                                <tr>
                                    <td>@post.CreatedAt.ToString()</td>
                                    <td><a asp-controller="Post" asp-action="Detail"asp-route-postId="@post.PostId">@post.Title.</a></td>
                                    <td>@post.AmountParticipant / @post.MaxParticipants คน</td>
                                    @* asp-controller="Post" asp-action="PostJoinList"  asp-route-postId="@post.PostId" *@
                                    <td><a class="btn view-members" 
                                            data-href="/Post/Members?postId=@post.PostId">ดูสมาชิก</a></td>
                                            @* data-href="viewmember.html">ดูสมาชิก</a></td> *@
                                    <td><a class="btn bg_blue" asp-controller="Post" asp-action="Edit" asp-route-postId="
                                            @post.PostId">แก้ไขโพสต์</a></td>
                                    <td><a class="btn cancal" data-confirm="คุณต้องการลบโพสต์ที่คุณสร้าง ใช่ไหม?"
                                            data-confirm-title="ยืนยันการยกเลิก" data-ok-text="ยืนยัน" data-cancel-text="ปิด"
                                            asp-controller="Post" asp-action="Delete"
                                            asp-route-postId="@post.PostId">ลบโพสต์</a></td>
                                    @if (post.Status == "Open")
                                    {
                                        <td><a class="btn join" asp-controller="Post" asp-action="Close" asp-route-postId="@post.PostId">เปิดรับสมัคร</a></td>
                                    }
                                    else if (post.Status == "Close")
                                    {
                                        <td><a class="btn join" asp-controller="Post" asp-action="Close" asp-route-postId="@post.PostId">ปิดรับสมัคร</a></td>
                                    }
                                    else if (post.Status == "Full"){
                                        <td><a class="btn join">สมาชิกเต็ม</a></td>
                                    }
                                    else if (post.Status == "Expired"){
                                        <td><a class="btn join">กิจกรรมหมดอายุ</a></td>
                                    }
                                    }
                                    @* <td><a class="btn join" id="toggleBtn" asp-controller="Post" asp-action="Close" asp-route-postId="@post.PostId">เปิดรับสมัคร</a></td> *@
                                </tr>
                            
                }
                        </tbody>
                        </table>
                    </div>
            }
        </div>
    </div>
    <!-- Overlay for View Member -->
    <div id="memberOverlay" class="overlay" hidden>
        <div class="overlay__backdrop" data-close></div>
        <div class="overlay__panel" role="dialog" aria-modal="true" aria-labelledby="ov-title">
            <button class="overlay__close btn bg_white" type="button" aria-label="ปิด" data-close>x</button>
            <div id="overlay-body" class="overlay-body">
                <!-- เนื้อหาของสมาชิกจะถูกโหลดที่นี่ -->
            </div>
        </div>
    </div>

</main>

<script src="~/js/fecth_viewmember.js"></script>
<script src="~/js/confrim.js"></script>
<script src="~/js/managepost_toggle.js"></script>