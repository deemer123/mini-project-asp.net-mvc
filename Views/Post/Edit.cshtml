@{
    ViewData["Title"] = "EditPost";
}
@model DemoVolunteer.Models.Post

<link rel="stylesheet" href="~/css/editpost.css" />


<main>
    <div class="content">
        <div class="container">
            <h2>แก้ไขโพสต์กิจกรรม</h2>

            <div class="addpost-image-container">
                @if(Model.ImgURL != null){
                    <img src="@Model.ImgURL" class="addpost-image" alt="กิจกรรม">
                }else{
                    <img src="~/img/default-post-pic.jpg" class="addpost-image" alt="กิจกรรม">
                }
                <button class="edit-button" aria-label="แก้ไขภาพ">✎</button>
            </div>
            

            <form method="POST" asp-action="Edit" asp-controller="Post" enctype="multipart/form-data">
                <input type="hidden" asp-for="PostId" value=@Model.PostId/>
                <div class="activity_img-overlay" id="activity_imgOverlay" hidden>
                    <div class="activity_img-modal" role="dialog" aria-modal="true" aria-labelledby="activity_imgTitle">
                        <h3 id="activity_imgTitle">เลือกภาพกิจกรรม</h3>
                        <p class="activity_img-hint">เลือกไฟล์รูปภาพจากเครื่องของคุณ</p>
                        <div class="activity_img-input">
                            <input type="file" id="activity_imgFile" accept="image/*" name="imageFile"/>
                        </div>

                        <p class="activity_img-error" id="activity_imgError" aria-live="polite"></p>

                        <div class="activity_img-actions">
                            <button type="button" class="btn" id="activity_imgCancel">ยกเลิก</button>
                            <button type="button" class="btn bg_blue" id="activity_imgConfirm">ยืนยัน</button>
                        </div>
                    </div>
                </div>
                <div>
                    <label>ชื่อกิจกรรมจิตอาสา</label>
                    <input asp-for="Title" type="text" name="title" placeholder="title" value=@Model.Title />
                </div>

                <div>
                    <label>กำหนดจำนวนผู้เข้าร่วม</label>
                    <input asp-for="MaxParticipants" type="number" name="MaxParticipants" placeholder="MaxParticipants"
                        value=@Model.MaxParticipants />
                </div>

                <div class="full-width">
                    <label>สถานที่จัดกิจกรรมจิตอาสา</label>
                    <input asp-for="Location" type="text" name="location" placeholder="location"
                        value=@Model.Location />

                </div>

                <div>
                    <label>ประเภทกิจกรรม</label>
                    <select asp-for="CategoryId" name="CategoryId">
                        @foreach (var category in @ViewBag.Categories)
                        {
                            <option value="@category.CategoryId">@category.Name</option>
                        }
                    </select>
                </div>


                <div>
                    <label>วันที่จัดกิจกรรม</label>
                    <div class="datetime-wrapper">
                        <input asp-for="AppointmentDate" type="date" name="AppointmentDate"
                            value="@Model.AppointmentDate.ToString("yyyy-MM-dd", System.Globalization.CultureInfo.InvariantCulture)" />

                        <p>ถึง</p>

                        <input asp-for="AppointmentDateArrive" type="date" name="AppointmentDateArrive" class="end-date"
                            value="@Model.AppointmentDateArrive?.ToString("yyyy-MM-dd", System.Globalization.CultureInfo.InvariantCulture)">
                    </div>
                </div>
                <div>
                    <label>ระยะเวลากิจกรรม</label>
                    <div class="datetime-wrapper">
                        <input asp-for="TimeStart" type="time" name="timestart" placeholder="time"
                            value="@Model.TimeStart.ToString("HH:mm")" />
                        <p>ถึง</p>
                        <input asp-for="TimeEnd" type="time" name="timeend" placeholder="time"
                            value="@Model.TimeEnd.ToString("HH:mm")" />
                    </div>
                </div>

                <div class="full-width">
                    <label>รายละเอียดกิจกรรม</label>
                    <textarea asp-for="Description" placeholder="พิมพ์รายละเอียดกิจกรรมของคุณ..." value=@Model.Description></textarea>
                </div>

                <div class="full-width">
                    <label>รูปภาพกิจกรรม</label>
                    <input type="file" id="imageInput2" accept="image/*" name="imageFile2"/>
                </div>
                @if(Model.AppointImg != null){
                    <img class='addpost-image' id="preview2" src=@Model.AppointImg alt="Image Preview">
                }


                <div class="full-width">
                    <label>เวลาปิดโพสต์กิจกรรม</label>
                    <div class="datetime-wrapper">
                        <input asp-for="AppointmentDateEnd" type="datetime-local" name="AppointmentDateEnd" class="close-date"
                            value="@Model.AppointmentDateEnd?.ToString("yyyy-MM-ddTHH:mm",System.Globalization.CultureInfo.InvariantCulture)">
                    </div>
                </div>

                <button type="submit" class="submit-btn">บันทึกโพสต์กิจกรรม</button>
            </form>
        </div>
</main>
<script src="~/js/post_choose_file.js"></script>

@* เปลื่ยน รูปภาพที่แสดงบน หน้าเว็บ *@

<script>
    const imageInput2 = document.getElementById('imageInput2');
    const preview2 = document.getElementById('preview2');


    imageInput2.addEventListener('change', function () {
        const file = this.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                preview2.src = e.target.result;
                preview2.style.display = 'block';
            }
            reader.readAsDataURL(file);
        }
    });
</script>